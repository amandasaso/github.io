<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="no-feedback" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Setting Up| Installed Collectors and Sources|Recommendations for Collections">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Recommendations for Linux Collections</title>
        <link href="Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="Resources/Stylesheets/Styles.css" rel="stylesheet" />
        <script src="Resources/Scripts/jquery.min.js">
        </script>
        <script src="Resources/Scripts/plugins.min.js">
        </script>
        <script src="Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="Default.htm#Recommendations_for_Linux_Collections.htm">Open topic with navigation</a>
        </p>
        <script type="text/javascript">/* <![CDATA[ */
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-16579649-1']);
			_gaq.push(['_trackPageview']);
			(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		/* ]]> */</script>
        <h1>Recommendations for Linux Collections</h1>
        <p>Many Sumo customers make extensive use of the Linux operating system for running their applications and for general infrastructure services. The question has come up "What should I be collecting from these devices, and what should I be looking for?" </p>
        <p>There are many different distributions of Linux and every customer will have different configurations. This guide is intended as a general starting point for collecting the standard operating logs from the most common Linux distributions. This document is not a guide for configuring application log collection, but rather a walk-through of collecting the basic operating system logs.</p>
        <h2>Collector Configuration</h2>
        <p>The first step before collecting files is to install and register a Sumo Logic Collector on the server, or on a host with connectivity to your server via the SSH protocol and then <a href="Configuring_a_Remote_File_Source.htm">set up a Remote File Source</a> to collect the logs of interest.</p>
        <p>The log files we are concerned with reside in /var/log and subdirectories of /var/log. At a minimum, SUMO LOGIC recommends collecting these log files if they are present on your system.</p>
        <p class="Tip"> Make sure you do a thorough analysis of your log directories (check  /var/log*)  and keep a list of filenames and filepaths for those file you want to collect.</p>
        <p>Skip to Category:</p>
        <ul>
            <li value="1"><a href="#Security">Security</a>
            </li>
            <li value="2"><a href="#System">Health</a>
            </li>
            <li value="3"><a href="#Mail">Mail</a>
            </li>
            <li value="4"><a href="#Audit">Audit</a>
            </li>
        </ul>
        <hr width="100%" size="0" align="center" />
        <h2><a name="Security"></a>Security Related Logs</h2>
        <table>
            <col style="width: 168px;" />
            <col style="width: 280px;" />
            <col style="width: 411px;" />
            <tbody>
                <tr>
                    <td style="font-weight: bold;">Log name</td>
                    <td style="font-weight: bold;">Purpose</td>
                    <td style="font-weight: bold;">Recommended Source Configuration Settings</td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">
                        <p>/var/log/aptitude</p>
                    </td>
                    <td>Logs from the debian/ubuntu package management system "aptitude" or apt.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/auth.log</td>
                    <td>This critical file contains basic Linux athentication logs.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1"> Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/dpkg.log</td>
                    <td>dpkg package management logs.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/faillog</td>
                    <td>Login failure logs.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/messages</td>
                    <td>This critical file contains most system messages occurring after a system is booted. <b>It's very important to collect this file if possible.</b></td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">
                        <p>/var/log/rpmpkgs</p>
                    </td>
                    <td>Logs from the package management system.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/secure</td>
                    <td>This critical file contains security-relevant logs, including authentication attempts and logs from sshd.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1"> Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/syslog</td>
                    <td>This critical file contains the logs being fed to syslog on a host. </td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Health or OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from log file: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/user.log</td>
                    <td>This file contains user-related logs.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: Leave this blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/yum.log</td>
                    <td>Logs from the yum package management system.</td>
                    <td style="font-size: 9pt;">
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: Leave this blank</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <h2><a name="System"></a>System Health Related Logs</h2>
        <p>&#160;</p>
        <table>
            <col style="width: 167px;" />
            <col style="width: 281px;" />
            <col style="width: 413px;" />
            <tbody>
                <tr>
                    <td style="font-weight: bold;">Log name</td>
                    <td style="font-weight: bold;">Purpose</td>
                    <td style="font-weight: bold;">Recommended Source Configuration Settings</td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/boot.log</td>
                    <td>Logs from system boot time.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Health</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/daemon.log</td>
                    <td>System application daemon logs.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Recommended Source Category: OS_Health</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/debug</td>
                    <td>Detailed debug logs for Debian-based Linux distributions.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Health</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/dmesg</td>
                    <td>Kernel logs from system boot time.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Health</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/kern</td>
                    <td>Kernel-level logs.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Categ--ory: OS_Health</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/kern.log</td>
                    <td>Kernel-level logs (same as var/log/kern).</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Health</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/syslog</td>
                    <td>This critical file contains the logs being fed to syslog on a host. <b>It's very important to collect this file if possible.</b></td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Health or OS_Security</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from log file: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <h2><a name="Mail"></a>Mail Related Logs</h2>
        <table>
            <col style="width: 167px;" />
            <col style="width: 281px;" />
            <col style="width: 413px;" />
            <tbody>
                <tr>
                    <td style="font-weight: bold;font-size: 9pt;">Log name</td>
                    <td style="font-weight: bold;">Purpose</td>
                    <td style="font-weight: bold;">Recommended Source Configuration Settings</td>
                </tr>
                <tr>
                    <td style="font-weight: bold;font-size: 9pt;">/var/log/maillog</td>
                    <td style="font-size: 9pt;">Typical location of sendmail logs.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Mail</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;font-size: 9pt;">/var/log/mail.log</td>
                    <td style="font-size: 9pt;">Typical location of postfix mail logs.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Mail</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;font-size: 9pt;">/var/log/mail.err</td>
                    <td style="font-size: 9pt;">Typical location of postfix mail logs.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Mail</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;font-size: 9pt;">/var/log/mail.info</td>
                    <td style="font-size: 9pt;">Typical location of postfix mail logs.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Recommended Source Category: OS_Mail</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td style="font-weight: bold;font-size: 9pt;">/var/log/mail.warn</td>
                    <td style="font-weight: bold;font-size: 9pt;"><span style="font-weight: normal;">Typical location of postfix mail logs.</span>
                    </td>
                    <td style="font-weight: bold;">
                        <ul>
                            <li style="font-size: 9pt;font-weight: normal;" value="1">Source Category: OS_Mail</li>
                            <li style="font-size: 9pt;font-weight: normal;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;font-weight: normal;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;font-weight: normal;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;font-weight: normal;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;font-weight: normal;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <h3>&#160;</h3>
        <h2><a name="Audit"></a>Audit Related Logs</h2>
        <table>
            <col style="width: 167px;" />
            <col style="width: 281px;" />
            <col style="width: 413px;" />
            <tbody>
                <tr>
                    <td style="font-weight: bold;">Log name</td>
                    <td style="font-weight: bold;">Purpose</td>
                    <td style="font-weight: bold;">Recommended Source Configuration Settings</td>
                </tr>
                <tr>
                    <td style="font-weight: bold;">/var/log/cron</td>
                    <td>Logs created by cron.</td>
                    <td>
                        <ul>
                            <li style="font-size: 9pt;" value="1">Source Category: OS_Audit</li>
                            <li style="font-size: 9pt;" value="2">Timestamp Parsing: Yes</li>
                            <li style="font-size: 9pt;" value="3">Use Timezone from Log File: Yes</li>
                            <li style="font-size: 9pt;" value="4">Multiline Processing: No</li>
                            <li style="font-size: 9pt;" value="5">Infer Boundaries: Yes</li>
                            <li style="font-size: 9pt;" value="6">Boundary Regex: OK to leave blank</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>&#160;</p>
        <p class="Important">Because /var/log/wtmp and /var/log/lastlog are binary log files you cannot collect that data in <span class="MyVariablesCompanyName">Sumo Logic</span>.</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="Default.htm#Recommendations_for_Linux_Collections.htm">Open topic with navigation</a>
        </p>
    </body>
</html>