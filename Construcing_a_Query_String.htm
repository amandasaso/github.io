<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="no-feedback" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Administration|Managing Users &amp; Roles|Managing Roles">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Constructing a query string</title>
        <link href="Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="Resources/Stylesheets/Styles.css" rel="stylesheet" />
        <script src="Resources/Scripts/jquery.min.js">
        </script>
        <script src="Resources/Scripts/plugins.min.js">
        </script>
        <script src="Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop" style="display: none;"><a href="Default.htm#Construcing_a_Query_String.htm">Open topic with navigation</a>
        </p>
        <script type="text/javascript">/* <![CDATA[ */
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-16579649-1']);
			_gaq.push(['_trackPageview']);
			(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
		/* ]]> */</script>
        <h1>Constructing a query string</h1>
        <p>A Query String defines access for a role. Limitations can be set based on <a href="#Restrict">several types of metadata</a>, or at the <a href="#Restrict2">record level</a>. String are silently added to the beginning of each query a user runs.</p>
        <p>As you type a string in the <b>New Role</b> dialog box,  supported metadata and record options are displayed to help you enter a well-defined string. Any errors in the string are underlined in red. </p>
        <p>For example, when creating the Ops Team Role, we first want to prevent Ops Team members from viewing billing information, which comes from a source named <b>bill</b>. When we type<code> !_source</code> into the Query String box, the list of Sources in our account appears, allowing us to see what options are allowed. We can either click the Source, or continue typing to see more options.</p>
        <p>
            <img src="Resources/Images/RBAC_creating_string_436x295.png" style="width: 436;height: 295;">
            </img>
        </p>
        <p class="Important">Role strings cannot include vertical pipes, "|". </p>
        <p>&#160;</p>
        <h3>Denying access to data </h3>
        <p>Denying a group of users to data is as simple as typing "!" in front of the metadata object or field that a role should not access. The "!" is treated as NOT in <span class="MyVariablesCompanyName">Sumo Logic</span> queries.</p>
        <p>Using our example from above, when a user assigned to the Ops Team role runs a search, <code>!_source=bill AND</code> is added to the search. So, for example, say that an Admin user ran a query, like:</p>
        <p><code>(error OR fail*) AND exception | count by _sourceCategory| sort by _count</code>
        </p>
        <p>The query produced aggregate results by sourceCategory--the results shown below on the left. If an Ops Team member ran that same query, he or she would see the results shown below on the right, because the search that is run looks like:<br></br></p>
        <p><code>!_source=bill AND(error OR fail*) AND exception | count by _sourceCategory| sort by _count</code> <![CDATA[ ]]></p>
        <p>Note that bill isn't represented at all because of the prefix.</p>
        <p>
            <img src="Resources/Images/RBAC_results_when_role_assigned.png">
            </img>
        </p>
        <h3>Granting access to data</h3>
        <p>What if you'd like to limit a role to a specific data set, or if you have a Collector that should only be accessed by certain users?&#160;Instead of denying access, you'll grant access to a data set by just typing that object in the Query String text box.</p>
        <p>For example, say we'd like to create a role for a team that needs to monitor firewall logs that are received by a specific <span class="MyVariablesCollector">Collector</span>. You could construct a query string like _collector=firewall*, which adds  <code>_collector=firewall*&#160;AND</code> to each query run by users in that group.</p>
        <h3><a name="Restrict"></a>Defining access based on metadata</h3>
        <p>You can restrict access to the following metadata fields:</p>
        <ul>
            <li value="1">_collector</li>
            <li value="2">_source</li>
            <li value="3">_sourceCategory</li>
            <li value="4">_sourceHost</li>
            <li value="5">_sourceName</li>
        </ul>
        <p>For example, let's say that our admin wants to create a role that prevents access to hosts named <b>humanresources</b>, <b>finance</b>, and <b>secret</b>. To create this role, he would type the following string:</p>
        <p class="Indent"><code>!_sourceHost=humanresources* and !_sourceName=*finance* and !_sourceCategory=*secret*</code>
        </p>
        <p>If a user with the above role runs a query like:</p>
        <p class="Indent"><code>error | count by _sourceHost</code>
        </p>
        <p>the following query is what <span class="MyVariablesCompanyName">Sumo Logic</span> actually runs:</p>
        <p class="Indent"><code>error and (!_sourceHost=humanresources* AND !_sourceName=*finance* AND !_sourceCategory=*secret* | count by _sourceHost</code>
        </p>
        <p>The results will exclude all results that were described by the role's restriction.</p>
        <p class="Tip">For more information on <span class="MyVariablesCompanyName">Sumo Logic</span> metadata fields, see <a href="Metadata_Searches.htm#Metadata_Searches.htm">Metadata Searches</a>.</p>
        <h3><a name="Restrict2"></a>Defining access based on records</h3>
        <p>You can create roles based on removing access to specific values in log messages. For example, let's say you'd like to create a role for a subset of users that should never see data that contain <code>userid</code>, or anything that matches <code>secret*</code>. </p>
        <p>In this case, constructing a role using this string:</p>
        <p class="Indent"><code>!userid and !secret*</code>
        </p>
        <p>means that if a user with the above role runs a query like:</p>
        <p class="Indent"><code>error |&#160;count by _sourceHos</code>t</p>
        <p>the following query is what <span class="MyVariablesCompanyName">Sumo Logic</span> actually runs:</p>
        <p class="Indent"><code>error AND(!userid AND !secret*) | count by _sourceHost</code>
        </p>
        <p>.</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkBottom" style="display: none;"><a href="Default.htm#Construcing_a_Query_String.htm">Open topic with navigation</a>
        </p>
    </body>
</html>